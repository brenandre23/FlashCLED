# ==============================================================================
# MODEL CONFIGURATION
# Methodology (Objectives, Metrics) is hardcoded in Python.
# This file controls Hyperparameters and Feature Selection.
# ==============================================================================

# 1. FORECAST HORIZONS
horizons:
  - name: "14d"
    steps: 1
  - name: "1m"
    steps: 2
  - name: "3m"
    steps: 6

# 2. GLOBAL THESIS PARAMETERS
# Used by the TwoStageEnsemble logic to weight rare events (~2% positive class)
# Note: The script calculates this dynamically, but this acts as a fallback.
hurdle_params:
  classifier_scale_pos_weight: 35.0

# 3. LEARNERS (Hyperparameters Only)
# NOTE: Do NOT add 'objective' or 'eval_metric' here. They are handled in train_models.py.
learners:
  xgboost:
    type: "xgboost"
    params:
      n_estimators: 1000
      learning_rate: 0.05
      max_depth: 6
      subsample: 0.8
      colsample_bytree: 0.8
      gamma: 1.0
      reg_alpha: 0.1
      reg_lambda: 1.0

  lightgbm:
    type: "lightgbm"
    params:
      n_estimators: 1000
      learning_rate: 0.05
      num_leaves: 31
      max_depth: -1
      subsample: 0.8
      colsample_bytree: 0.8
      reg_alpha: 0.1
      reg_lambda: 1.0
      verbose: -1

# 4. SUBMODEL THEMES
# ==============================================================================
# CRITICAL: Feature names MUST match actual DB column names in either:
#   - car_cewp.temporal_features (dynamic/time-varying features)
#   - car_cewp.features_static (static/geographic features)
# ==============================================================================
submodels:
  conflict_history:
    enabled: true
    features:
      - "fatalities_1m_lag"
      - "events_3m_lag"
      # - "days_since_last_event"  # Not currently generated
      - "conflict_density_10km"
      - "regional_risk_score_lag1"

  economics:
    enabled: true
    features:
      - "price_maize"
      - "price_maize_shock"
      - "price_rice"
      - "price_rice_shock"
      - "price_oil"
      - "price_oil_shock"
      - "gold_price_usd_lag1"
      - "dist_to_city"

  environmental:
    enabled: true
    features:
      - "chirps_precip_anomaly"
      - "era5_temp_anomaly"
      - "era5_soil_moisture_anomaly"
      - "ndvi_anomaly"
      - "nightlights_intensity"
      - "water_coverage_lag1"

  epr:
    enabled: true
    features:
      - "epr_excluded_groups_count"
      - "epr_horizontal_inequality"
      - "epr_status_mean"

  terrain:
    enabled: true
    features:
      - "elevation_mean"
      - "slope_mean"
      - "terrain_ruggedness_index"
      - "dist_to_road"
      - "dist_to_city"
      - "dist_to_river"
      - "dist_to_diamond_mine"
      - "dist_to_gold_mine"
      - "dist_to_large_mine"
      - "dist_to_controlled_mine"
      - "dist_to_large_gold_mine"

  temporal_context:
    enabled: true
    features:
      - "month_sin"
      - "month_cos"
      - "is_dry_season"

  # REQUIRED: The script looks for this specific key for dimensionality reduction
  broad_pca:
    enabled: true
    variance_retention: 0.90
